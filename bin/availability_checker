#!/usr/bin/env ruby

require "bundler/setup"
require "sources/monitor/availability_checker"

SourcesApiClient.configure do |config|
  config.scheme = ENV["SOURCES_SCHEME"]
  config.host   = "#{ENV["SOURCES_HOST"]}:#{ENV["SOURCES_PORT"]}"
end

begin
  Sources::Monitor::AvailabilityChecker.new(ARGV.shift).check_sources
rescue => e
  puts e.message
  puts e.backtrace
end
